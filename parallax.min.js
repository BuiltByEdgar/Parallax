/**********************************************************************************
 *
 * Parallax.js: Mouse parallax effect
 *
 * Parallax.js is a lightweight and simple mouse parallax effect. Simple to use 
 * and works with the mouse and soon reacts to the orientation of your smart device.
 * 
 *
 * @author:  Edgar Bermejo - @BuiltByEdgar - http://builtbyedgar.com/
 * @version: 0.0.1 - Beta (11/07/2015)
 * @repository: https://github.com/BuiltByEdgar/Parallax
 * @license: MIT License
 *
 *
 * @container { DOM Object }
 * @options { Object }:
 * @power: Float (default = .5). How much 3D effect to use (from 0 to 10)
 * @axis: "x", "y" or "both". In which axis to apply the "3D" effect
 * @scope: "global" or "local". From which base coordinate system to calculate 
 * the mouse position and parallax effect
 *
 *
 **********************************************************************************/

 "use strict";function Parallax(a,b){var c={className:"parallax",power:.5,axis:"x",scope:"global"};this._extend(c,b),this.o=c,this.container=a,this.capture=null,this.el=[],this.pointer={x:0,y:0,cx:0,cy:0},this.transformPrefix=this._getPrefix(["transform","-ms-transform","-moz-transform","-webkit-transform","-o-transform"]),this.windowWidth=window.innerWidth,this.windowHeight=window.innerHeight,window.addEventListener("DOMContentLoaded",this._load.bind(this),!1),window.addEventListener("resize",this._resize.bind(this),!1)}Parallax.prototype._load=function(){"global"===this.o.scope?this.capture=document:this.capture=this.container,this.capture.addEventListener("mousemove",this._mouseMoveHandler.bind(this),!1),this.el=document.getElementsByClassName(this.o.className),window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||null}(),this._run()},Parallax.prototype._mouseMoveHandler=function(a){this.pointer.x=a.pageX,this.pointer.y=a.pageY},Parallax.prototype._run=function(){var a=this;this.pointer.cx+=(this.pointer.x-this.pointer.cx)/10,this.pointer.cy+=(this.pointer.y-this.pointer.cy)/10,[].forEach.call(this.el,function(b){var c=0,d=0,e=(b.dataset.power||this.o.power)/10;("x"===a.o.axis||"both"===a.o.axis)&&(c=(a.pointer.cx-.5*a.windowWidth)*-e),("y"===a.o.axis||"both"===a.o.axis)&&(d=(a.pointer.cy-.5*a.windowHeight)*-e),b.style[a.transformPrefix]="matrix3d( 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, "+c+", "+d+", 0, 1 )"}),requestAnimFrame(this._run.bind(this))},Parallax.prototype._getPrefix=function(a){for(var c=(document.createElement("div"),""),d=0;d<a.length;d++){c=a[d];break}return c},Parallax.prototype._resize=function(a){this.windowWidth=window.innerWidth,this.windowHeight=window.innerHeight},Parallax.prototype._isMobile=function(a){return navigator.userAgent.match(/Android|BlackBerry|iPhone|iPad|iPod|Opera Mini|IEMobile/i)?!0:!1},Parallax.prototype._extend=function(a,b){for(var c in b)b[c]&&b[c].constructor&&b[c].constructor===Object?(a[c]=a[c]||{},arguments.callee(a[c],b[c])):a[c]=b[c];return a};