/**********************************************************************************
 *
 * Parallax.js: Mouse parallax effect
 *
 * Parallax.js is a lightweight and simple mouse parallax effect. Simple to use 
 * and works with the mouse and reacts to the orientation of your smart device.
 * 
 *
 * @author:  Edgar Bermejo - @BuiltByEdgar - http://builtbyedgar.com/
 * @version: 0.1.2 - Beta (29/08/2015)
 * @repository: https://github.com/BuiltByEdgar/Parallax
 * @license: MIT License
 *
 *
 * @container { DOM Object }
 * @options { Object }:
 * @power: Float (default = .5). How much 3D effect to use (from 0 to 10).
 * @axis: "x", "y" or "both". In which axis to apply the "3D" effect.
 * @controls: "mouse" or "orientation". Determine which is the event to controll it.
 * @scope: "global" or "local". From which base coordinate system to calculate 
 * the mouse position and parallax effect.
 *
 *
 **********************************************************************************/

 "use strict";function Parallax(a,b){var c={className:"parallax",power:.5,axis:"x",controls:"mouse",scope:"global"};this._extend(c,b),this.o=c,this.container=a,this.capture=null,this.el=[],this.transformPrefix=this._getPrefix(["transform","-ms-transform","-moz-transform","-webkit-transform","-o-transform"]),this.windowWidth=window.innerWidth,this.windowHeight=window.innerHeight,window.addEventListener("DOMContentLoaded",this._load.bind(this),!1),window.addEventListener("resize",this._resize.bind(this),!1)}Parallax.prototype._load=function(){"global"===this.o.scope?this.capture=document:this.capture=this.container,"orientation"===this.o.controls||this._isMobile()?(this.orientation={x:0,y:0,cx:0,cy:0},window.addEventListener("deviceorientation",this._deviceOrientationHandler.bind(this),!1)):(this.pointer={x:0,y:0,cx:0,cy:0},this.capture.addEventListener("mousemove",this._mouseMoveHandler.bind(this),!1)),this.el=document.getElementsByClassName(this.o.className),window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||null}(),this._run()},Parallax.prototype._deviceOrientationHandler=function(a){(a.gamma>2||a.gamma<-2)&&(this.orientation.x=a.gamma),(a.beta>2||a.beta<-2)&&(this.orientation.y=a.beta)},Parallax.prototype._mouseMoveHandler=function(a){this.pointer.x=a.pageX,this.pointer.y=a.pageY},Parallax.prototype._run=function(){for(var a=this,d=0,e=this.el.length;e>d;d++){var f=0,g=0,h=a.el[d],i=(h.dataset.power||a.o.power)/10;"orientation"===a.o.controls||a._isMobile()?(a.orientation.cx+=(a.orientation.x-a.orientation.cx)/10,a.orientation.cy+=(a.orientation.y-a.orientation.cy)/10,("x"===a.o.axis||"both"===a.o.axis)&&(f=10*a.orientation.cx*-i),("y"===a.o.axis||"both"===a.o.axis)&&(g=10*a.orientation.cy*-i)):(a.pointer.cx+=(a.pointer.x-a.pointer.cx)/10,a.pointer.cy+=(a.pointer.y-a.pointer.cy)/10,("x"===a.o.axis||"both"===a.o.axis)&&(f=(a.pointer.cx-.5*a.windowWidth)*-i),("y"===a.o.axis||"both"===a.o.axis)&&(g=(a.pointer.cy-.5*a.windowHeight)*-i)),h.style[a.transformPrefix]="matrix3d( 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, "+f+", "+g+", 0, 1 )"}requestAnimFrame(this._run.bind(this))},Parallax.prototype._getPrefix=function(a){for(var c=(document.createElement("div"),""),d=0;d<a.length;d++){c=a[d];break}return c},Parallax.prototype._resize=function(a){this.windowWidth=window.innerWidth,this.windowHeight=window.innerHeight},Parallax.prototype._isMobile=function(a){return navigator.userAgent.match(/Android|BlackBerry|iPhone|iPad|iPod|Opera Mini|IEMobile/i)?!0:!1},Parallax.prototype._extend=function(a,b){for(var c in b)b[c]&&b[c].constructor&&b[c].constructor===Object?(a[c]=a[c]||{},arguments.callee(a[c],b[c])):a[c]=b[c];return a};